<%- include("templates/header.ejs", {titulo: "Pacientes"}) %>

    <div class="container my-4">
        <h2>Gestión de Pacientes</h2>
        
        <div id="message"></div>
        
        <form id="patientForm" action="/api/pacientes" method="POST" class="mb-3">
            <h4 class="mb-3">Registrar Nuevo Paciente</h4>
            <div class="row g-2">
                <div class="col"><input class="form-control" name="firstName" placeholder="Nombre(s)" required></div>
                <div class="col"><input class="form-control" name="lastName" placeholder="Apellido(s)" required></div>
                <div class="col"><input class="form-control" name="phone" placeholder="Teléfono" type="tel"></div>
                <div class="col"><input class="form-control" name="email" placeholder="Correo Electrónico" type="email"></div>
            </div>
            <button class="btn btn-primary mt-2">Agregar Paciente</button>
        </form>

        <hr>

        <h4 class="mb-3">Lista de Pacientes Registrados</h4>
        
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Nombre Completo</th>
                    <th>Contacto</th>
                    <th>ID</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                <% pacientesBD.forEach((paciente) => { %>
                <tr>
                    <td><strong><%= paciente.firstName %> <%= paciente.lastName %></strong></td>
                    <td><%= paciente.phone || 'N/A' %> / <%= paciente.email || 'N/A' %></td>
                    <td><small><%= paciente._id %></small></td>
                    <td>
                        <a href="/pacientes/editar/<%= paciente._id %>" class="btn btn-sm btn-info text-white me-2">Modificar</a>
                        <form action="/api/pacientes/borrar/<%= paciente._id %>" method="POST" style="display:inline;">
                            <button type="submit" class="btn btn-sm btn-danger">Eliminar</button>
                        </form>
                    </td>
                </tr>
                <% }) %>
                <% if (pacientesBD.length === 0) { %>
                    <tr><td colspan="4" class="text-center text-secondary">No hay pacientes registrados.</td></tr>
                <% } %>
            </tbody>
        </table>
    </div>
    
<%- include("templates/flooter.ejs") %>